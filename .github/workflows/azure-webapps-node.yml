#!/bin/bash

# ----------------------------
# NautilusOS-OneFile GitHub Pages deploy script
# ----------------------------

# Variables
REPO_URL="https://github.com/bammywhamee/NautilusOS-1.git"
BRANCH="main"
FOLDER="NautilusOS-OneFile"

# Step 0: Check if git is installed
if ! command -v git &> /dev/null
then
    echo "Git is not installed. Please install Git first."
    exit 1
fi

# Step 1: Navigate to script folder
cd "$(dirname "$0")" || exit

# Step 2: Clone repo if not exists
if [ ! -d ".git" ]; then
    echo "Cloning repo..."
    git clone $REPO_URL temp-deploy
    cd temp-deploy || exit
else
    echo "Repo already exists, using current folder"
fi

# Step 3: Copy OneFile contents to repo root
echo "Copying $FOLDER contents..."
rsync -av --delete "../$FOLDER/" ./  # sync OneFile folder to repo root

# Step 4: Add, commit, push
git add .
git commit -m "Deploy latest NautilusOS-OneFile"
git push origin $BRANCH

echo "âœ… Deployment complete! Check your GitHub Pages site."
